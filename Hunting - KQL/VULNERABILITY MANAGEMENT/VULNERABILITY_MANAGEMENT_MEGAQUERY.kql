// Investigating the tables
DeviceTvmSoftwareVulnerabilities
| take 2

// Investigating the vulnerable software vendors
DeviceTvmSoftwareVulnerabilities
| distinct SoftwareVendor

// Exclude software vendor microsoft
DeviceTvmSoftwareVulnerabilities
| where SoftwareVendor != 'microsoft'

// exclude microsoft but output software name
DeviceTvmSoftwareVulnerabilities
| where SoftwareVendor != 'microsoft'
| distinct SoftwareName

// Search vulnerabilities that are classified as critical
DeviceTvmSoftwareVulnerabilitiesKB
| where VulnerabilitySeverityLevel == 'Critical'

// Search vulnerabilities that are classified as critical and CVE ID = 2024*
DeviceTvmSoftwareVulnerabilitiesKB
| where VulnerabilitySeverityLevel == 'Critical'
| where CveId has "2024"
| where IsExploitAvailable != 0
| order by LastModifiedTime

// search fortinet vulnerabilities
DeviceTvmSoftwareVulnerabilitiesKB
| search "fortinet"
| where IsExploitAvailable != 0


// search fortinet vulnerabilities
DeviceTvmSoftwareVulnerabilitiesKB
| search "fortinet"
| where IsExploitAvailable != 0
| summarize count() by VulnerabilitySeverityLevel, CvssScore
| order by CvssScore

// search fortinet critical vulnerabilities
DeviceTvmSoftwareVulnerabilitiesKB
| search "fortinet"
| where IsExploitAvailable != 0
| where VulnerabilitySeverityLevel =~ 'critical'
| order by LastModifiedTime