// info pläjäys
DeviceTvmSoftwareVulnerabilities
| take 2

// ensipurema haavoittuvuuksiin
DeviceTvmSoftwareVulnerabilities
| project DeviceName, SoftwareVendor, SoftwareName, SoftwareVersion, CveId, VulnerabilitySeverityLevel

// ensipurema haavoittuvuuksiin
DeviceTvmSoftwareVulnerabilities
| take 2

| project DeviceName, SoftwareVendor, SoftwareName, SoftwareVersion, CveId, VulnerabilitySeverityLevel

DeviceInfo
| take 2

DeviceInfo
| where DeviceType == 'Server'

DeviceInfo
| where DeviceType == 'Server'
| where OSPlatform != 'Linux'

// join table !! // megajoin
DeviceInfo
| where DeviceType == 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId

// join table !! // megajoin
DeviceInfo
| where DeviceType == 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| summarize count() by DeviceName, VulnerabilitySeverityLevel
| order by VulnerabilitySeverityLevel



// join table !! // megajoin
DeviceInfo
| where DeviceType == 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| where IsExploitAvailable != 0
| summarize count() by SoftwareName



// join table !! // megajoin
DeviceInfo
| where DeviceType != 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| where IsExploitAvailable != 0
| distinct DeviceName, SoftwareName, SoftwareVersion

// join table !! // megajoin
DeviceInfo
| where DeviceType != 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| where IsExploitAvailable != 0
| distinct DeviceName, CveId, CvssScore, VulnerabilitySeverityLevel, SoftwareName, SoftwareVersion
| order by CvssScore

// join table !! // megajoin
DeviceInfo
| where DeviceType != 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| distinct DeviceName, CveId, CvssScore, VulnerabilitySeverityLevel, SoftwareName, SoftwareVersion
| order by CvssScore


// join table !! // megajoin
DeviceInfo
| where DeviceType != 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| summarize count() by RecommendedSecurityUpdate, DeviceName
| order by RecommendedSecurityUpdate

DeviceInfo
| where DeviceType != 'Server'
| where OSPlatform != 'Linux'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| summarize count() by DeviceName, VulnerabilitySeverityLevel
| order by count_

DeviceInfo
| where DeviceName == 'mb-winclient.internal.niseko.alpineskihouse.co'
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| summarize count() by VulnerabilitySeverityLevel, SoftwareVendor, SoftwareName

// find openssl vulnerabilities
DeviceInfo
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceName
| join kind=inner DeviceTvmSoftwareVulnerabilitiesKB on CveId
| where SoftwareName == 'openssl'
| distinct DeviceName, SoftwareName, SoftwareVersion, CveId, CvssScore, IsExploitAvailable, ExposureLevel
| order by ExposureLevel