// extract machine groups --- not much on this environment
DeviceInfo
| distinct MachineGroup

// extract tags
DeviceInfo
| distinct DeviceManualTags

// devices that do not belong to AlpineSkiHouse
DeviceInfo
| where DeviceManualTags != 'AlpineSkiHouse'

// inactive devices
DeviceInfo
| where SensorHealthState != 'Active'
| distinct DeviceName

// what kind devices are "inactive"
DeviceInfo
| where SensorHealthState != 'Active'
| distinct OnboardingStatus

DeviceInfo
| where SensorHealthState != 'Active'
| take 2

// AV info
DeviceTvmInfoGathering
| take 2

// jotain AV moodia
DeviceTvmInfoGathering
| extend d=parse_json(AdditionalFields)
| extend AvModeValue = d.AvMode
| extend AvEngineVersion = d.AvEngineVersion
| extend AvSignatureVersion = d.AvSignatureVersion
| extend AvPlatformVersion = d.AvPlatformVersion
| project DeviceName, AvModeValue, AvEngineVersion, AvSignatureVersion, AvPlatformVersion
| order by DeviceName

DeviceTvmInfoGathering
| where DeviceName == 'desktop-kns84tp'


// jotain AV moodia
DeviceTvmInfoGathering
| extend d=parse_json(AdditionalFields)
| extend AvModeValue = d.AvMode
| extend AvEngineVersion = d.AvEngineVersion
| extend AvSignatureVersion = d.AvSignatureVersion
| extend AvPlatformVersion = d.AvPlatformVersion
| where AvPlatformVersion != ''
| project DeviceName, AvModeValue, AvEngineVersion, AvSignatureVersion, AvPlatformVersion
| order by DeviceName